06-07.Vulkan-RenderPass知识点串联与梳理

好，各位同学大家好，我们学习到现在啊，已经学习了很多的组件了，像pipeline啊，像radar pass啊等等啊，我们看到了很多很多，里面非常零碎的知识点。
那么这节课呢？
我们来把知识啊，进行一个整合跟梳理，让大家能站在一个全局跟悉部这两种角度去观测一下，我们现在学到的知识体系。
首先啊，我们开始看这张图。
现在咱们的程序呢，是已经把这些都做完了，第一个红框对吧，直接成为基础的渲染准备条件，其中呢，与我们渲染息息相关，最为直接的就是s。
然后在s里面呢，我们有三个frame buffer啊，三个frame buffer对吧？
第二个部分我们已经做好了一条pipeline，然后呢，我们还做好了一个，其中还有一个surpass。
那么，这个render pass呢？
saber pass的编号也都被设置到了我们的pipeline里面。
好，这是我们现在做到的事情，那么我们假设先不看这些东西，我们就研究一下这两个东西啊，因为这个比较简单，这两个东西呢，比较复杂。
首先，我们在全局感受一下wal CON的渲染流程。
pavement和render pass首先我们先看render pass，在render pass当中呢，我们知道啊，它可以包含多个stop pass就是子流程。
在我们啊，渲染的过程当中，会添加两个虚拟流程，一个是extern，一个是另外一个extern啊，一进一出，那么这两个的话呢，可以理解为它什么都不干，什么都没有啊，只是发出了一系列的虚拟的消息，方便完整我们的流程。
那么，每两个流程之间都会有一个dependency，这个dependency呢？
它就决定了在上一个流程啊，上一个流程，它的哪一个pipeline的阶段？
的什么操作完成之后，那么下一个操下一个流程，它的哪个阶段的哪个任务啊？
或者说哪个阶段的哪个操作可以执行？
OK，那么dependency呢？
就是这么个作用，然后呢？
我们还做了几个什么呢？
attachment description啊，我们知道attachment description，它是描述了即将输入到管线当中的那一些attachment图片。
的相关的信息，它只是一个描述符，只是一个描述信息，那么假设我们现在有三个描述信息，分别是两个color attachment描述，一个深度attachment的描述。
那么，由于我们还有个什么呢啊？
还有一个attachment reference，它解决了一个什么问题呢？
那就是每一个sabo pass，它到底引用了这个attachment？
这堆attachment当中的哪一个？
或者是哪几个？
作为什么呢？
作为画布，它有可能会引入一张画布，也有可能会引入两张画布，分别把不同的信息画到两张画布上，也是有可能的，对吧？
我们看，对于赛欧哈斯零，它引入了零号跟一号，所以说呢，是关联了这个数组当中的零号和一号。
x1引入了二号，那么它就关联了，只关联了这个深度啊，只关联了深度，它这么。
它关联了零号啊，它就画在零号上面，所以说我们看啊，这样的话呢，又串联了这三种东西啊，那么接下来我们要看一看什么呢这个？
we nd pipeline pipeline是个什么东西呢？
它是一个surpass的渲染细节，比如我们要执行surpass 0啊，那么啊，用到的就是这个p line，这个p line里面会跟会告诉这1 pass里面啊，说我要绘制的是一个三角形，而不是线。
然后呢？
我要采用什么样的share袋进行绘制，我是否开启深度检测？
我是否开启blend颜色混合等等，那么这个pass就依靠这个管线做完了。
那么，对于这个pass来讲，它可能有另外一条管线。
那么，它用另外一条管线也可以走完这个渲染流程。
所以，我们讲一个pipeline可以用于一个sub pass。
如果有多个不同的sa pos as的话，就可以构建不同的PA po line，供他们来进行使用。
那到底如何去绑定哪个paddle line运行？
哪个tab pass呢？
这个就需要使用到我们的指令指令呢？
会在后续进行讲解。
另外，需要强调的是，pipeline与ra pass都是渲染模式的设置，它不会设置真实的数据，比如说图片和顶点等等。
我们在puppet里面，我们有些layout，有些vertex attribute description，还有spending description等等，它们都只是描述了我希望收到怎样的信息，那么这些信息是如何进行排布，我如何解读它们？
那对于他们来讲的话呢啊，萨帕斯他只是说我希望得到这两这两个描述期所描述的那样子的图片OK，那么数据都是在选区间动态绑定到命令上的啊，又是命令。
OK，我们继续看，对于一个frame buffer，我们之前啊，在最后写了一个frame buffer的时候，那么frame buffer到底做了哪些事情呢？
看一个fling buffer里面啊，它可能会绑定，比如说两张color attachment image，大家这写成了不是description，而是image这个fling buffer啊，它才是切切实实的绑定上了啊，作为了一个图片的集合啊，那么这三张图片各自呢有各自的用，那么请问fling buffer它知道这三张图片的用处吗？
他其实并不知道那么这三张图片的记载信息在哪里啊？
其实是在这三个家伙当中啊，进行描述这三个家伙进行描述，那么到底如何知道这三个图片啊？
这三种描述信息哪个是深度，哪个是颜色呢？
呃，那么就得通过sub pass当中，大家还记得吗？
有我们做了add color，它这边的函数我们也做了set depths stent I al attachment，这样的函数这两个函数在哪？
在s在sub pass这个类里面呢？
所以最终啊，其实是在运行萨罗帕斯之后就会知道啊，哪些是用来做color，哪些是用来做深度OK，那么真正的图片呢？
它的集合就被存在了，复印八本里面。
那么，福音八法会被输送到gpu，随后呢，比如说看一个sa as 0，它呢，引用了零号跟一号这两个啊a color attachment e script ion。
OK，我们也输送过去，他说呀，请用它这边的数组的零和一进行绘制，那么关于这两张图片的描述信息，请到零和一的里面去寻找什么零一去寻找？
哎，是从attachment description啊，这个描述信息的零号和一号里面去找OK，这样我们就收集齐了描述信息呢，通过说sub pass里面的设置啊reference，我们知道哦，它所用的这个attachment呀是。
是零号和一号，那么这张图片从哪找呢？
从frame buffer所包含的这个图片数组里面的零号一号，我取出来用，然后呢？
那么我们如何理解这两张图片它的格式啊？
layout呀，它的格式灯，还有说它的layout转换等等这些东西呢？
我就去到attachment description里面去找啊，它因为它记载了这些的信息好，这下我就把这些信息搞全了，好那么搞全这些信息之后，我们要看一看gpu如何利用这些信息进行绘制。
那么就是图片的流程，首先对于sa as 0来讲，它呢，有一个attachment image 0假设啊，此时啊，它只引用了这个attachment image 0。
那么，这个touch ment 0啊，它目前的layout的格式是undefined对吧啊？
它初始的格式是undefined，然后呢？
由于attachment reference 0有个要求，我说了这个零号图片呢，我希望在进入三八八四零的时候。
你给我改成color attachment奥特曼，这样的格式方便我这一趴啊，向上面绘制输出输出这个颜色，于是gpu在这自动的加了一个barrier barrier啊，被称为屏障啊，我们后面会使用这个结构。
那barrier呢？
它的作用就是组在管线的中间，上下两两个流程啊，给它分开，那么只有在转换完毕之后才会下面的流程。
那这个barrier呢？
它就把它转化成了一个诶，这样的格式，这样的layout，还有colored optimal啊，方便了这个fragment的代的输出，随后呢，就进行了渲染，开始向上输出数据了。
数据输出完毕之后，然后呢？
attachment description 0号，大家注意啊，这边是reference的要求，这边的话呢，是description的要求啊，它的要求是什么呢？
它是说呀，所有的流动渲染完毕之后。
现在我们的假设是什么？
假设是只有一个surpass 0哦，那么这次渲染是不是就已经完全走完整个render pass了？
那么我们还记得在description里面要求说，当你走完整个render pass之后，我希望最终把它变成一个present optimal的格式。
用于显示嘛，对不对啊？
上面可能还有三个pass啊，全走完了，那么这边才会启用description里面的要求说成present optimal就是final layout。
然后到这边儿又插入了一个zen barrier，给它转换barrier，转换为之后诶形成了这样一张图片进行输出啊present optimal OK，那么这一系列的流程走完之后啊，我们就啊，能够仔细的去呃，就是思考了对不对那个这个希望，也希望大家能够自己去啊，多看几遍这个视频啊，这个视频还是很重要的。
好的，那么呃，也叫我们之前所讲的内存相关的东西啊barrier里面到底说什么呢？
是不是是不是也是那种啊？
这个首先同步阶段，然后同步它的操作，对吧啊？
同步操作的话呢？
为了什么呀？
可能是为了这个内存从SM 0到到它的这个公共的和公共的内存，然后呢再？
把它对于SM 1给a的报表啊，是不是也是走这个流程呢？
是的，就自动barrier这边走的OK，那么关于这些东西，我们就讲到这里。

